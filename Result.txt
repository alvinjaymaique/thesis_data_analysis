Chapter 4: Results and Discussion
4.1 Anomaly Detection Results
4.1.1 Clustering Performance Evaluation
In this study, five clustering algorithms were evaluated for their effectiveness in identifying power quality anomalies in sensor readings: K-Means, Spectral Clustering, Agglomerative Clustering, Ward Hierarchical Clustering, and Gaussian Mixture Model. These algorithms were selected based on their diverse approaches to cluster formation and their suitability for identifying distinct patterns in multidimensional power quality data.

Clustering Algorithm Performance Comparison
The table below presents the performance metrics for each algorithm evaluated on the sensor dataset:
Algorithm
Silhouette Score
Davies-Bouldin Index
Calinski-Harabasz Index
Number of Clusters
KMeans
0.5321
0.8690
17239.31
15
SpectralClustering
-0.0949
1.9033
37.67
4
AgglomerativeClustering
0.5066
0.8446
15943.21
12
WardHierarchical
0.5066
0.8446
15943.21
12
GaussianMixture
0.4806
0.9706
13172.41
6


These metrics provide different perspectives on clustering quality:
Silhouette Score measures how similar an object is to its own cluster compared to other clusters. The range is from -1 to 1, where higher values indicate better-defined clusters. KMeans achieved the highest score (0.5321), indicating well-separated and cohesive clusters.
Davies-Bouldin Index evaluates intra-cluster similarity and inter-cluster differences, with lower values indicating better clustering. AgglomerativeClustering and WardHierarchical performed best (0.8446), closely followed by KMeans (0.8690).
Calinski-Harabasz Index (Variance Ratio Criterion) measures the ratio of between-cluster dispersion to within-cluster dispersion, with higher values indicating better-defined clusters. KMeans substantially outperformed other algorithms (17239.31).

PCA Visualization of Clustering Results
To visualize the high-dimensional clustering results, Principal Component Analysis (PCA) was applied to reduce the feature space to two dimensions while preserving maximum variance. Figure 1 shows the PCA visualization of the KMeans clustering results:

PCA Visualization of KMeans Clustering
The PCA projection demonstrates clear separation between most clusters, particularly those representing distinct anomaly types. The first two principal components captured approximately 73% of the total variance in the dataset, indicating that the visualization provides a reasonable representation of the cluster distribution.

Selection of Optimal Clustering Model
KMeans was selected as the optimal clustering algorithm for the following reasons:

Superior performance on key metrics: KMeans achieved the highest Silhouette Score (0.5321) and Calinski-Harabasz Index (17239.31), indicating well-separated clusters with high cohesion.
Appropriate cluster granularity: With 15 clusters, KMeans provided sufficient granularity to distinguish between different types of power quality anomalies while avoiding over-segmentation.
Computational efficiency: KMeans completed in significantly less time than hierarchical and spectral methods, making it more practical for large-scale deployment.
Interpretability: The centroids generated by KMeans provided clear, interpretable patterns that could be directly mapped to known power quality anomalies.
While AgglomerativeClustering showed a slightly better Davies-Bouldin Index, the overall pattern of metrics favored KMeans as the most balanced performer across all evaluation criteria.
Spectral Clustering performed poorly in this application, likely due to the complex structure of the power quality data that doesn't align well with the manifold assumptions of spectral methods. The negative Silhouette Score (-0.0949) suggests that many data points might have been assigned to inappropriate clusters.
The optimal number of clusters (k=15) for KMeans was determined through comprehensive evaluation of metrics for values of k ranging from 2 to 15, with particular focus on the Silhouette Score, which showed continuous improvement up to k=15, indicating meaningful cluster separation even at higher granularity.
In the next section, we will examine how these clusters were mapped to specific anomaly types and analyze their distribution across different locations in Cebu.

Clustering Metrics Across Varying Cluster Counts
To determine the optimal number of clusters and assess how each algorithm responds to varying values of k, clustering performance metrics were computed across a range of k=2 to k=15. Figure 2 illustrates the trend of Silhouette Score, Davies-Bouldin Index, and Calinski-Harabasz Index for each algorithm:

Figure 2. Clustering Metric Comparison across Varying Cluster Counts
Silhouette Score trends reveal that KMeans consistently improved as k increased, peaking at k=15, further supporting its selection. Agglomerative and Ward Hierarchical Clustering also demonstrated strong cohesion, while Spectral Clustering's performance declined at higher values of k, even becoming unstable.


Davies-Bouldin Index showed that lower values were generally achieved by Agglomerative and Ward Clustering, especially in the range k=10 to k=12, suggesting compact clusters with good separation. KMeans also performed well and maintained stability.


Calinski-Harabasz Index indicated that KMeans formed the most compact and well-separated clusters overall, with a clear maximum at k=15. Agglomerative and Ward methods showed competitive performance but peaked slightly earlier.


This comparative analysis across varying cluster counts provides robust support for choosing KMeans with k=15 as the optimal configuration. It not only achieved the best individual metric values but also demonstrated consistent improvement and stability across metrics.


4.1.2 Anomaly Classification Results
Following the identification of optimal clustering parameters, each cluster was analyzed to determine its electrical characteristics and the corresponding anomaly type. Table 4.2 provides a detailed classification of power quality clusters, outlining the specific numerical thresholds for key electrical parameters. This classification framework forms the foundation for anomaly identification and supports the supervised learning process by assigning labels to distinct operational and anomaly states.
Cluster
Load Type
Voltage Behavior
Power Factor
Key Observation / Anomaly
Label
0
Light Load (<2A, <400W)
Nominal with peaks >242.6V
Good (0.75-0.85)
Voltage surge under light load
LightLoad_VoltageSurge
1
No Load (Idle) (<0.01A)
Elevated (233-246V), >242.6V
N/A (<0.1)
Overvoltage during idle state
Idle_Overvoltage
2
Light Load (<2A, <400W)
Undervoltage (<217.4V, min 214V)
Moderate (0.7-0.8)
Undervoltage during light load
LightLoad_Undervoltage
3
Very High Load (>20A, >5000W)
Severe swings (212-249V, ±7.8%)
Excellent (>0.98)
High load with voltage instability
HighLoad_VoltageInstability
4
High Load (10-16A, 2400-3200W)
Extreme dips (<155V), ±21% variation
Good (>0.9)
Severe transients during high load
HighLoad_SevereTransients
5
No Load (Idle) (<0.01A)
Sustained undervoltage (203-224V)
Very Low (<0.3)
Undervoltage at idle, systemic issue
Idle_Undervoltage
6
Moderate Load (0.6-1.0A, 80-120W)
Mild fluctuation (221-245V)
Very Poor (0.42-0.56)
Reactive load with poor PF
LowPF_ReactiveLoad
7
Low-Moderate (0.3-0.4A, 35-40W)
Occasional surges (225-245V)
Moderate (0.50-0.55)
Minor surges with PF issues
ModeratePF_MinorSurge
8
High Load (12-16A, 2300-3900W)
Wide variation (210-245V, σ=12.8V)
Moderate (0.7-0.85)
Mixed voltage anomalies at high load
HighLoad_MixedAnomalies
9
Light Load (0.2-0.95A, <100W)
Sustained undervoltage (201-222V)
Poor (0.40-0.45)
Combined low PF and undervoltage
LightLoad_Undervoltage_LowPF
10
Light Load (0.5-2.0A, <250W)
Slightly elevated (230-245V)
Good (0.77-0.80)
Minor voltage surges, efficient load
LightLoad_MinorSurge
11
High Load (5-7A, 1200-1800W)
Stable (225-246V)
Excellent (0.90-0.95)
Ideal high load operation
HighLoad_Optimal
12
No Load (Idle) (<0.01A)
Very stable (235-241V)
N/A (<0.1)
Baseline idle condition
Idle_Stable
13
High Load (5-6A, 950-1350W)
Stable (221-245V)
Near Unity (0.96-0.98)
Excellent operation at high load
HighLoad_Excellent
14
Very High Load (>20A, 4000-5400W)
Stable (235-248V)
Near Unity (0.98-0.99)
Peak load with excellent power quality
PeakLoad_Excellent

Table 4.2: Power Quality Cluster Classification with Numerical Thresholds
This table categorizes each cluster based on combinations of load conditions, voltage behavior, and power factor. The numerical thresholds defined for each cluster enable precise identification of power quality issues, ranging from undervoltage and overvoltage to power factor imbalances and load intensity anomalies. The resulting classification not only enhances automated anomaly detection but also aids in the interpretability of power quality conditions, providing clear guidelines for addressing various operational states.

Visualization of Clustered Electrical Parameters
To validate the separation between identified clusters and assess their alignment with predefined anomaly thresholds, key electrical parameters—voltage, power factor, current, and power—were visualized across all cluster labels. The following figures illustrate the distribution of these parameters, highlighting operational conditions such as undervoltage, overvoltage, reactive power issues, and load intensity. These visualizations support the interpretability of clustering results and provide a basis for assigning anomaly-type labels in subsequent supervised classification.

Figure 4.2: Cluster Size Distribution Across Identified Operational States
This figure shows the number of data points assigned to each cluster, indicating the frequency of occurrence for different operational and anomaly types. Larger clusters typically represent steady-state or nominal conditions, while smaller clusters often capture rare or extreme power quality issues. Understanding cluster sizes is critical for evaluating anomaly prevalence and ensuring appropriate handling of class imbalance in downstream supervised models.


Figure 4.3: Voltage Distribution Across Clusters
This figure illustrates the voltage distribution within each identified cluster. Dashed lines at 217.4 V and 242.6 V represent the defined anomaly thresholds, highlighting clusters with undervoltage and overvoltage conditions.

Figure 4.4: Power Factor Distribution Across Clusters
Power factor distribution across clusters is shown with thresholds at 0.5, 0.7, and 0.85. These boundaries categorize power factor quality from poor to excellent and help differentiate operational states with reactive power issues.

Figure 4.5: Current Distribution Across Clusters
The current distribution highlights load intensity within each cluster. Clusters are distinguishable based on typical current draw, aiding in classifying operations from idle to very high load.


Figure 4.6: Power Consumption Patterns Across Clusters
This figure presents the active power consumption range for each cluster. It reflects the energy usage characteristics and supports the identification of light, moderate, and heavy load scenarios.

